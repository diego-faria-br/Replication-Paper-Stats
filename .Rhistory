)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5, colour = "cutoff"),size=1)+
xlab("R")+
ylab("S")+
annotate("text", x = C(2,6), y = c(6,2), label = C("M=0","M=1"))+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5, colour = "cutoff"),size=1)+
xlab("R")+
ylab("S")+
annotate("text", x = C(2,6), y = c(6,2), label = c("M=0","M=1"))+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5, colour = "cutoff"),size=1)+
xlab("R")+
ylab("S")+
annotate("text", x = C(2), y = c(6), label = c("M=1"))+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5, colour = "cutoff"),size=1)+
xlab("R")+
ylab("S")+
annotate("text", x = (2), y = (6), label = "M=1")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5, colour = "cutoff"),size=1)+
xlab("R")+
ylab("S")+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5, colour = "cutoff"),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0, 0)) +
scale_y_continuous(limits = c(0,10), expand = c(0, 0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5, colour = "cutoff",fill=FALSE),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0, 0)) +
scale_y_continuous(limits = c(0,10), expand = c(0, 0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5, colour = "cutoff"),size=1)+
guides(fill=FALSE) +
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0, 0)) +
scale_y_continuous(limits = c(0,10), expand = c(0, 0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5, colour = "cutoff"),size=1)+
theme(legend.position="none") +
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0, 0)) +
scale_y_continuous(limits = c(0,10), expand = c(0, 0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
theme(legend.position="none") +
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0, 0)) +
scale_y_continuous(limits = c(0,10), expand = c(0, 0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0, 0)) +
scale_y_continuous(limits = c(0,10), expand = c(0, 0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0, 0)) +
scale_y_continuous(limits = c(0,10), expand = c(0, 0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(      axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0, 0)) +
scale_y_continuous(limits = c(0,10), expand = c(0, 0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(      axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(1, 1)) +
scale_y_continuous(limits = c(0,10), expand = c(0, 0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(      axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(.1, .1)) +
scale_y_continuous(limits = c(0,10), expand = c(0, 0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(      axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(.1, .1)) +
scale_y_continuous(limits = c(0,10), expand = c(0.1, 0.1))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(      axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(.1, .1)) +
scale_y_continuous(limits = c(0,10), expand = c(0.1, 0.1))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(      axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
element_line(arrow = arrow())
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
par(c())
scale_x_continuous(limits = c(0,10), expand = c(.1, .1)) +
scale_y_continuous(limits = c(0,10), expand = c(0.1, 0.1))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(      axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line = element_line(arrow = arrow())
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(.1, .1)) +
scale_y_continuous(limits = c(0,10), expand = c(0.1, 0.1))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(      axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line = element_line(arrow = arrow())
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0,0)) +
scale_y_continuous(limits = c(0,10), expand = c(0,0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(      axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line = element_line(arrow = arrow())
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0,0)) +
scale_y_continuous(limits = c(0,10), expand = c(0,0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
theme(      panel.grid = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line = element_line(arrow = arrow())
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0,0)) +
scale_y_continuous(limits = c(0,10), expand = c(0,0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
title("Qualified Majority")
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0,0)) +
scale_y_continuous(limits = c(0,10), expand = c(0,0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
title("Qualified Majority")+
theme(      panel.grid = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line = element_line(arrow = arrow())
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0,0)) +
scale_y_continuous(limits = c(0,10), expand = c(0,0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
ggtitle("Qualified Majority")+
theme(      panel.grid = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line = element_line(arrow = arrow())
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0,0)) +
scale_y_continuous(limits = c(0,10), expand = c(0,0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
ggtitle("Qualified Majority")+
theme(plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line = element_line(arrow = arrow())
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 5, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0,0)) +
scale_y_continuous(limits = c(0,10), expand = c(0,0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
ggtitle("Qualified Majority")+
theme(plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line = element_line(arrow = arrow())
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 5, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0,0)) +
scale_y_continuous(limits = c(0,10), expand = c(0,0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
ggtitle("One Sided Rule")+
theme(plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line = element_line(arrow = arrow())
)
ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 1, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0,0)) +
scale_y_continuous(limits = c(0,10), expand = c(0,0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
ggtitle("General Linear With Default Bias")+
theme(plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line = element_line(arrow = arrow())
)
p2<-ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 5, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0,0)) +
scale_y_continuous(limits = c(0,10), expand = c(0,0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
ggtitle("One sided ")+
theme(plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line = element_line(arrow = arrow())
)
p3<-ggplot(dt,aes(x=xa,y=ya))+geom_smooth(method = "lm")+
geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),size=1)+
xlab("R")+
ylab("S")+
scale_x_continuous(limits = c(0,10), expand = c(0,0)) +
scale_y_continuous(limits = c(0,10), expand = c(0,0))+
annotate("text", x = (2), y = (6), label = "M=0")+
annotate("text", x = (6), y = (2), label = "M=1")+
ggtitle("Qualified Majority")+
theme(plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line = element_line(arrow = arrow())
)
p2
p3
install.packages("flexdashboard")
ls()
data<-read.csv("article_data.csv")
library(flexdashboard)
library(flexdashboard)
library(shiny)
library(tidyverse)
rm(list = ls())
data<-read.csv("article_data.csv")
data <- data %>%
mutate(data=as.Date(data))
data <- data %>%
mutate(data=as.Date(data))
data <- data %>%
mutate(data=as.Date(date()))
data <- data %>%
mutate(data=as.Date(date))
renderPlot({
pltData <- data %>%
filter(date >=input$dateRange[1] & date <=input$dateRange[2], publisher==input$outlet) %>%
select(-data,-publisher) %>%
summarize_all(funs(sum)) %>%
gather(candidate,count,Trump:Gabbard)
pubPlot <-ggplot(pltData,aes(x=candidate,y=count,fill=candidate))+geom_bar(stat="identity")
pubPlot
})
renderPlot({
pltData <- data %>%
filter(date >=input$dateRange[1] & date <=input$dateRange[2], publisher==input$outlet) %>%
select(-data,-publisher) %>%
summarize_all(funs(sum)) %>%
gather(candidate,count,Trump:Gabbard)
pubPlot <-ggplot(pltData,aes(x=candidate,y=count,fill=candidate))+geom_bar(stat="identity")
pubPlot
})
library(flexdashboard)
library(shiny)
library(tidyverse)
rm(list = ls())
data <- read.csv("article_data.csv")
data <- data %>%
mutate(date = as.Date(date))
selectInput("outlet",
label = "Select a news outlet:",
choices = sort(unique(data$publisher)),
selected = "AP")
dateRangeInput("dateRange",
"Date range:",
start = "2020-03-01",
end   = "2020-04-14")
library(flexdashboard)
library(shiny)
library(tidyverse)
rm(list = ls())
data<-read.csv("article_data.csv")
data <- data %>%
mutate(data=as.Date(date))
selectInput("outlet",
label="Select a News Outlet",
choices = sort(unique(data$publisher)),
selected ="AP")
dateRangeInput("dateRange",
label = "Date Range",
start = "2020-03-01",
end = "2020-04-14")
selectInput("outlet",
label="Select a News Outlet",
choices = sort(unique(data$publisher)),
selected ="AP")
library(tidyr)
library(dplyr)
library(ggplot2)
tindex <- read.csv("T index.csv")
setwd("~/GitHub/Replication-Paper-Stats")
rm(list = ls())
